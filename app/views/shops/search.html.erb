<!-- app/views/shops/search.html.erb -->
<div class="max-w-xl mx-auto mt-12 p-6 bg-white rounded-xl shadow-md space-y-4">
  <h1 class="text-xl font-bold text-center">自転車店を検索</h1>

  <%= form_with url: result_shops_path, method: :get, local: true do |f| %>
    <div>
      <%= f.label :address, "住所を入力", class: "block font-semibold" %>
      <%= f.text_field :address, class: "w-full p-2 border rounded" %>
    </div>

    <div class="flex justify-between mt-4">
      <button type="button" onclick="getCurrentLocation()" class="bg-green-500 hover:bg-green-600 text-brack py-2 px-4 rounded">
        現在地から探す
      </button>

      <%= f.submit "検索", class: "bg-blue-500 hover:bg-blue-600 text-brack py-2 px-4 rounded" %>
    </div>

    <%= hidden_field_tag :lat %>
    <%= hidden_field_tag :lng %>
  <% end %>
</div>

<script>
  function getCurrentLocation() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(function(position) {
        document.querySelector('input[name="lat"]').value = position.coords.latitude;
        document.querySelector('input[name="lng"]').value = position.coords.longitude;
      }, function() {
        alert("位置情報の取得に失敗しました。");
      });
    } else {
      alert("お使いのブラウザでは位置情報取得がサポートされていません。");
    }
  }
</script>

<div>
  <%= link_to '戻る', root_path %>
</div>
